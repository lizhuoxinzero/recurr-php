#include "datemap.h"
#include <strings.h>
#include <time.h>
#include "php.h"

#define NUM_OF_YEARS 150
#define DAYTIME 86400  //一天多少秒
#define MIN_YEAR 1970

int lunar_to_solar(int year, int month, int day, int isleap, solar_data_t *pSolarData);
int solar_to_lunar(int year, int month, int dayi, lunar_data_t *pLunarData);

static int getIndex(int year, int month, int isleap);
static void parseLunarData(int year, int month, lunar_data_t * pLunarData);
static int getMonthSize(__uint32_t bitdata, int month, int isleap);


/************************************************
*农历各个月的天数大小
*格式： 第几个月是闰月（4bit）12个正常月（12bit）,闰月（1bit）
************************************************/
static __uint32_t years_info[200] = {
    0x12da, 0xa9ba, 0x95a, 0x149a, 0x9a9a, 
    0x1a4a, 0x11aaa, 0x16a8, 0x16d4, 0xd2b5, 
    0x12b6, 0x936, 0x952e, 0x1496, 0x1564e, 
    0xd4a, 0xda8, 0xd5e8, 0x156c, 0x12ae, 
    0xa95e, 0x92e, 0xc96, 0x6e94, 0x1d4a, 
    0x10d6a, 0xb58, 0x156c, 0xb2da, 0x125c, 
    0x192c, 0x9b2a, 0x1a94, 0x1b4a, 0x4eaa, 
    0xad4, 0xf576, 0x4ba, 0x125a, 0xb956, 
    0x152a, 0x1694, 0x9754, 0x15aa, 0x12aba, 
    0x974, 0x14b6, 0xca2f, 0xa56, 0x1526, 
    0x8f2a, 0xd54, 0x15aa, 0x4b6a, 0x96c, 
    0xd4dc, 0x149c, 0x1a4c, 0xbd4c, 0x1aa6, 
    0xb54, 0x6ed4, 0x12da, 0x1695e, 0x95a, 
    0x149a, 0xda17, 0x1a4a, 0x1aa4, 0xbba8, 
    0x16b4, 0xada, 0x4ab6, 0x936, 0xf4ae, 
    0x1496, 0x154a, 0xb64b, 0xda4, 0x15b4, 
    0x696d, 0x126e, 0x1093e, 0x92e, 0xc96, 
    0xcd15, 0x1d4a, 0xd64, 0x94d9, 0x155c, 
    0x125c, 0x7a5c, 0x192c, 0xfaaa, 0x1a94, 
    0x1b4a, 0xabaa, 0xad4, 0x14da, 0x8aba, 
    0xa5a, 0x11536, 0x152a, 0x1694, 0xd6d4, 
    0x15aa, 0xab4, 0x9574, 0x14b6, 0xa56, 
    0x764e, 0xd26, 0xee66, 0xd54, 0x15aa, 
    0xa96b, 0x96c, 0x14ae, 0x8a9c, 0x1a4c, 
    0x11d2c, 0x1aa4, 0x1b54, 0xcd55, 0xada, 
    0x95c, 0x953a, 0x149a, 0x1a2a, 0x5e4a, 
    0x1aa4 
};




/************************************************
*农历月初映射到公历的时间戳 1970-2100
************************************************/
static __int64_t ltos_map[200][14] ={
    {0, 3081600, 5673600, 8179200, 10684800, 13276800, 15782400, 18374400, 20966400, 23472000, 26064000, 28656000, 31161600 },
    {5, 33753600, 36259200, 38851200, 41356800, 43862400, 46454400, 48960000, 51552000, 54057600, 56649600, 59241600, 61833600, 64339200 },
    {0, 66931200, 69436800, 72028800, 74534400, 77040000, 79632000, 82137600, 84729600, 87235200, 89827200, 92419200, 94924800 },
    {0, 97516800, 100108800, 102614400, 105206400, 107712000, 110217600, 112809600, 115315200, 117820800, 120412800, 123004800, 125510400 },
    {4, 128102400, 130694400, 133286400, 135792000, 138384000, 140889600, 143395200, 145987200, 148492800, 150998400, 153590400, 156182400, 158688000 },
    {0, 161280000, 163872000, 166464000, 168969600, 171561600, 174067200, 176572800, 179164800, 181670400, 184176000, 186768000, 189273600 },
    {8, 191865600, 194457600, 197049600, 199555200, 202147200, 204652800, 207244800, 209750400, 212342400, 214848000, 217353600, 219945600, 222451200 },
    {0, 225043200, 227635200, 230140800, 232732800, 235324800, 237830400, 240422400, 242928000, 245520000, 248025600, 250617600, 253123200 },
    {0, 255628800, 258220800, 260726400, 263318400, 265910400, 268416000, 271008000, 273600000, 276105600, 278697600, 281203200, 283795200 },
    {6, 286300800, 288892800, 291398400, 293904000, 296496000, 299001600, 301593600, 304185600, 306691200, 309283200, 311875200, 314380800, 316972800 },
    {0, 319478400, 322070400, 324576000, 327081600, 329673600, 332179200, 334771200, 337276800, 339868800, 342460800, 344966400, 347558400 },
    {0, 350150400, 352656000, 355248000, 357753600, 360259200, 362851200, 365356800, 367862400, 370454400, 373046400, 375552000, 378144000 },
    {4, 380736000, 383328000, 385833600, 388425600, 390931200, 393436800, 396028800, 398534400, 401040000, 403632000, 406137600, 408729600, 411321600 },
    {0, 413913600, 416505600, 419011200, 421603200, 424108800, 426614400, 429206400, 431712000, 434217600, 436809600, 439315200, 441907200 },
    {10, 444499200, 447091200, 449596800, 452188800, 454780800, 457286400, 459792000, 462384000, 464889600, 467395200, 469987200, 472492800, 475084800 },
    {0, 477676800, 480182400, 482774400, 485366400, 487872000, 490464000, 492969600, 495561600, 498067200, 500572800, 503164800, 505670400 },
    {0, 508262400, 510768000, 513360000, 515948400, 518454000, 521046000, 523638000, 526143600, 528739200, 531244800, 533836800, 536342400 },
    {6, 538848000, 541440000, 543945600, 546534000, 549039600, 551631600, 554223600, 556729200, 559324800, 561916800, 564422400, 567014400, 569520000 },
    {0, 572025600, 574617600, 577119600, 579711600, 582217200, 584809200, 587314800, 589910400, 592502400, 595008000, 597600000, 600192000 },
    {0, 602697600, 605289600, 607795200, 610297200, 612889200, 615394800, 617986800, 620492400, 623088000, 625593600, 628185600, 630777600 },
    {5, 633369600, 635875200, 638467200, 640969200, 643474800, 646066800, 648572400, 651078000, 653673600, 656179200, 658771200, 661363200, 663955200 },
    {0, 666547200, 669052800, 671641200, 674146800, 676652400, 679244400, 681750000, 684255600, 686851200, 689356800, 691948800, 694540800 },
    {0, 697132800, 699638400, 702230400, 704822400, 707328000, 709833600, 712425600, 714931200, 717436800, 720028800, 722534400, 725126400 },
    {3, 727718400, 730224000, 732816000, 735408000, 737913600, 740505600, 743011200, 745603200, 748108800, 750614400, 753206400, 755712000, 758304000 },
    {0, 760809600, 763401600, 765993600, 768585600, 771091200, 773683200, 776188800, 778780800, 781286400, 783792000, 786384000, 788889600 },
    {8, 791481600, 793987200, 796579200, 799171200, 801676800, 804268800, 806774400, 809366400, 811958400, 814464000, 816969600, 819561600, 822067200 },
    {0, 824659200, 827164800, 829756800, 832262400, 834854400, 837446400, 839952000, 842544000, 845049600, 847641600, 850233600, 852739200 },
    {0, 855244800, 857836800, 860342400, 862934400, 865440000, 868032000, 870537600, 873129600, 875721600, 878227200, 880819200, 883411200 },
    {5, 885916800, 888508800, 891014400, 893520000, 896112000, 898617600, 901123200, 903715200, 906307200, 908812800, 911404800, 913996800, 916502400 },
    {0, 919094400, 921686400, 924192000, 926697600, 929289600, 931795200, 934300800, 936892800, 939398400, 941990400, 944582400, 947174400 },
    {0, 949680000, 952272000, 954864000, 957369600, 959875200, 962467200, 964972800, 967478400, 970070400, 972576000, 975168000, 977760000 },
    {4, 980265600, 982857600, 985449600, 987955200, 990547200, 993052800, 995644800, 998150400, 1000656000, 1003248000, 1005753600, 1008345600, 1010851200 },
    {0, 1013443200, 1016035200, 1018627200, 1021132800, 1023724800, 1026230400, 1028822400, 1031328000, 1033833600, 1036425600, 1038931200, 1041523200 },
    {0, 1044028800, 1046620800, 1049212800, 1051718400, 1054310400, 1056902400, 1059408000, 1062000000, 1064505600, 1067011200, 1069603200, 1072108800 },
    {2, 1074700800, 1077206400, 1079798400, 1082304000, 1084896000, 1087488000, 1089993600, 1092585600, 1095091200, 1097683200, 1100188800, 1102780800, 1105286400 },
    {0, 1107878400, 1110384000, 1112976000, 1115481600, 1118073600, 1120579200, 1123171200, 1125763200, 1128268800, 1130860800, 1133366400, 1135958400 },
    {7, 1138464000, 1141056000, 1143561600, 1146153600, 1148659200, 1151251200, 1153756800, 1156348800, 1158854400, 1161446400, 1164038400, 1166544000, 1169136000 },
    {0, 1171728000, 1174233600, 1176739200, 1179331200, 1181836800, 1184342400, 1186934400, 1189440000, 1192032000, 1194624000, 1197216000, 1199721600 },
    {0, 1202313600, 1204905600, 1207411200, 1209916800, 1212508800, 1215014400, 1217520000, 1220112000, 1222617600, 1225209600, 1227801600, 1230307200 },
    {5, 1232899200, 1235491200, 1238083200, 1240588800, 1243094400, 1245686400, 1248192000, 1250697600, 1253289600, 1255795200, 1258387200, 1260892800, 1263484800 },
    {0, 1266076800, 1268668800, 1271174400, 1273766400, 1276272000, 1278864000, 1281369600, 1283875200, 1286467200, 1288972800, 1291564800, 1294070400 },
    {0, 1296662400, 1299254400, 1301760000, 1304352000, 1306944000, 1309449600, 1312041600, 1314547200, 1317052800, 1319644800, 1322150400, 1324742400 },
    {4, 1327248000, 1329840000, 1332345600, 1334937600, 1337529600, 1340035200, 1342627200, 1345132800, 1347724800, 1350230400, 1352822400, 1355328000, 1357920000 },
    {0, 1360425600, 1363017600, 1365523200, 1368115200, 1370620800, 1373212800, 1375804800, 1378310400, 1380902400, 1383408000, 1386000000, 1388505600 },
    {9, 1391097600, 1393603200, 1396195200, 1398700800, 1401292800, 1403798400, 1406390400, 1408896000, 1411488000, 1414080000, 1416585600, 1419177600, 1421683200 },
    {0, 1424275200, 1426780800, 1429372800, 1431878400, 1434384000, 1436976000, 1439481600, 1442073600, 1444665600, 1447257600, 1449763200, 1452355200 },
    {0, 1454860800, 1457452800, 1459958400, 1462550400, 1465056000, 1467561600, 1470153600, 1472659200, 1475251200, 1477843200, 1480348800, 1482940800 },
    {6, 1485532800, 1488038400, 1490630400, 1493136000, 1495728000, 1498233600, 1500739200, 1503331200, 1505836800, 1508428800, 1510934400, 1513526400, 1516118400 },
    {0, 1518710400, 1521216000, 1523808000, 1526313600, 1528905600, 1531411200, 1533916800, 1536508800, 1539014400, 1541606400, 1544112000, 1546704000 },
    {0, 1549296000, 1551888000, 1554393600, 1556985600, 1559491200, 1562083200, 1564588800, 1567094400, 1569686400, 1572192000, 1574697600, 1577289600 },
    {4, 1579881600, 1582387200, 1584979200, 1587571200, 1590163200, 1592668800, 1595260800, 1597766400, 1600272000, 1602864000, 1605369600, 1607961600, 1610467200 },
    {0, 1613059200, 1615564800, 1618156800, 1620748800, 1623254400, 1625846400, 1628352000, 1630944000, 1633449600, 1636041600, 1638547200, 1641139200 },
    {0, 1643644800, 1646236800, 1648742400, 1651334400, 1653840000, 1656432000, 1659024000, 1661529600, 1664121600, 1666627200, 1669219200, 1671724800 },
    {2, 1674316800, 1676822400, 1679414400, 1681920000, 1684425600, 1687017600, 1689609600, 1692115200, 1694707200, 1697299200, 1699804800, 1702396800, 1704902400 },
    {0, 1707494400, 1710000000, 1712592000, 1715097600, 1717603200, 1720195200, 1722700800, 1725292800, 1727884800, 1730390400, 1732982400, 1735574400 },
    {6, 1738080000, 1740672000, 1743177600, 1745769600, 1748275200, 1750780800, 1753372800, 1755878400, 1758470400, 1760976000, 1763568000, 1766160000, 1768752000 },
    {0, 1771257600, 1773849600, 1776355200, 1778947200, 1781452800, 1783958400, 1786550400, 1789056000, 1791561600, 1794153600, 1796745600, 1799337600 },
    {0, 1801843200, 1804435200, 1807027200, 1809532800, 1812124800, 1814630400, 1817136000, 1819728000, 1822233600, 1824739200, 1827331200, 1829923200 },
    {5, 1832428800, 1835020800, 1837612800, 1840204800, 1842710400, 1845302400, 1847808000, 1850313600, 1852905600, 1855411200, 1857916800, 1860508800, 1863100800 },
    {0, 1865606400, 1868198400, 1870790400, 1873296000, 1875888000, 1878393600, 1880985600, 1883491200, 1886083200, 1888588800, 1891094400, 1893686400 },
    {0, 1896278400, 1898784000, 1901376000, 1903881600, 1906473600, 1909065600, 1911571200, 1914163200, 1916668800, 1919260800, 1921766400, 1924358400 },
    {3, 1926864000, 1929369600, 1931961600, 1934553600, 1937059200, 1939651200, 1942156800, 1944748800, 1947340800, 1949846400, 1952438400, 1954944000, 1957536000 },
    {0, 1960041600, 1962633600, 1965139200, 1967644800, 1970236800, 1972742400, 1975334400, 1977926400, 1980432000, 1983024000, 1985616000, 1988121600 },
    {11, 1990713600, 1993219200, 1995811200, 1998316800, 2000822400, 2003414400, 2005920000, 2008512000, 2011017600, 2013609600, 2016201600, 2018793600, 2021299200 },
    {0, 2023891200, 2026396800, 2028988800, 2031494400, 2034000000, 2036592000, 2039097600, 2041689600, 2044195200, 2046787200, 2049379200, 2051884800 },
    {0, 2054476800, 2057068800, 2059574400, 2062166400, 2064672000, 2067177600, 2069769600, 2072275200, 2074780800, 2077372800, 2079964800, 2082470400 },
    {6, 2085062400, 2087654400, 2090246400, 2092752000, 2095344000, 2097849600, 2100355200, 2102947200, 2105452800, 2107958400, 2110550400, 2113056000, 2115648000 },
    {0, 2118240000, 2120832000, 2123424000, 2125929600, 2128521600, 2131027200, 2133532800, 2136124800, 2138630400, 2141136000, 2143728000, 2146233600 },
    {0, 2148825600, 2151417600, 2154009600, 2156515200, 2159107200, 2161612800, 2164204800, 2166710400, 2169302400, 2171808000, 2174313600, 2176905600 },
    {5, 2179411200, 2182003200, 2184595200, 2187100800, 2189692800, 2192284800, 2194790400, 2197382400, 2199888000, 2202480000, 2204985600, 2207577600, 2210083200 },
    {0, 2212588800, 2215180800, 2217686400, 2220278400, 2222870400, 2225376000, 2227968000, 2230473600, 2233065600, 2235657600, 2238163200, 2240755200 },
    {0, 2243260800, 2245766400, 2248358400, 2250864000, 2253456000, 2255961600, 2258553600, 2261145600, 2263651200, 2266243200, 2268835200, 2271340800 },
    {2, 2273932800, 2276438400, 2279030400, 2281536000, 2284041600, 2286633600, 2289139200, 2291731200, 2294236800, 2296828800, 2299420800, 2301926400, 2304518400 },
    {0, 2307110400, 2309616000, 2312208000, 2314713600, 2317219200, 2319811200, 2322316800, 2324822400, 2327414400, 2330006400, 2332512000, 2335104000 },
    {7, 2337696000, 2340288000, 2342793600, 2345385600, 2347891200, 2350396800, 2352988800, 2355494400, 2358000000, 2360592000, 2363097600, 2365689600, 2368281600 },
    {0, 2370873600, 2373465600, 2375971200, 2378563200, 2381068800, 2383574400, 2386166400, 2388672000, 2391177600, 2393769600, 2396275200, 2398867200 },
    {0, 2401459200, 2404051200, 2406556800, 2409148800, 2411654400, 2414246400, 2416752000, 2419344000, 2421849600, 2424355200, 2426947200, 2429452800 },
    {5, 2432044800, 2434636800, 2437142400, 2439734400, 2442326400, 2444832000, 2447424000, 2449929600, 2452521600, 2455027200, 2457532800, 2460124800, 2462630400 },
    {0, 2465222400, 2467728000, 2470320000, 2472912000, 2475417600, 2478009600, 2480601600, 2483107200, 2485699200, 2488204800, 2490710400, 2493302400 },
    {0, 2495808000, 2498400000, 2500905600, 2503497600, 2506003200, 2508595200, 2511187200, 2513692800, 2516284800, 2518876800, 2521382400, 2523974400 },
    {3, 2526480000, 2528985600, 2531577600, 2534083200, 2536675200, 2539180800, 2541772800, 2544278400, 2546870400, 2549462400, 2551968000, 2554560000, 2557152000 },
    {0, 2559657600, 2562249600, 2564755200, 2567260800, 2569852800, 2572358400, 2574864000, 2577456000, 2580048000, 2582553600, 2585145600, 2587737600 },
    {8, 2590329600, 2592835200, 2595427200, 2597932800, 2600438400, 2603030400, 2605536000, 2608041600, 2610633600, 2613139200, 2615731200, 2618323200, 2620915200 },
    {0, 2623507200, 2626012800, 2628604800, 2631110400, 2633616000, 2636208000, 2638713600, 2641219200, 2643811200, 2646316800, 2648908800, 2651500800 },
    {0, 2654092800, 2656598400, 2659190400, 2661782400, 2664288000, 2666793600, 2669385600, 2671891200, 2674396800, 2676988800, 2679494400, 2682086400 },
    {6, 2684678400, 2687184000, 2689776000, 2692368000, 2694873600, 2697465600, 2699971200, 2702563200, 2705068800, 2707574400, 2710166400, 2712672000, 2715264000 },
    {0, 2717769600, 2720361600, 2722953600, 2725545600, 2728051200, 2730643200, 2733148800, 2735740800, 2738246400, 2740752000, 2743344000, 2745849600 },
    {0, 2748441600, 2750947200, 2753539200, 2756131200, 2758636800, 2761228800, 2763734400, 2766326400, 2768918400, 2771424000, 2773929600, 2776521600 },
    {4, 2779027200, 2781619200, 2784124800, 2786716800, 2789222400, 2791814400, 2794320000, 2796912000, 2799504000, 2802009600, 2804601600, 2807193600, 2809699200 },
    {0, 2812204800, 2814796800, 2817302400, 2819894400, 2822400000, 2824992000, 2827497600, 2830089600, 2832595200, 2835187200, 2837779200, 2840371200 },
    {0, 2842876800, 2845468800, 2847974400, 2850480000, 2853072000, 2855577600, 2858083200, 2860675200, 2863180800, 2865772800, 2868364800, 2870956800 },
    {3, 2873462400, 2876054400, 2878646400, 2881152000, 2883657600, 2886249600, 2888755200, 2891260800, 2893852800, 2896358400, 2898950400, 2901542400, 2904134400 },
    {0, 2906640000, 2909232000, 2911824000, 2914329600, 2916835200, 2919427200, 2921932800, 2924438400, 2927030400, 2929536000, 2932128000, 2934720000 },
    {7, 2937225600, 2939817600, 2942409600, 2944915200, 2947507200, 2950012800, 2952604800, 2955110400, 2957616000, 2960208000, 2962713600, 2965305600, 2967811200 },
    {0, 2970403200, 2972995200, 2975587200, 2978092800, 2980684800, 2983190400, 2985782400, 2988288000, 2990793600, 2993385600, 2995891200, 2998483200 },
    {0, 3000988800, 3003580800, 3006172800, 3008678400, 3011270400, 3013862400, 3016368000, 3018960000, 3021465600, 3023971200, 3026563200, 3029068800 },
    {5, 3031660800, 3034166400, 3036758400, 3039264000, 3041856000, 3044448000, 3046953600, 3049545600, 3052051200, 3054643200, 3057148800, 3059740800, 3062246400 },
    {0, 3064838400, 3067344000, 3069936000, 3072441600, 3075033600, 3077539200, 3080131200, 3082723200, 3085228800, 3087820800, 3090326400, 3092918400 },
    {0, 3095424000, 3098016000, 3100521600, 3103113600, 3105619200, 3108124800, 3110716800, 3113308800, 3115814400, 3118406400, 3120998400, 3123504000 },
    {4, 3126096000, 3128601600, 3131193600, 3133699200, 3136291200, 3138796800, 3141302400, 3143894400, 3146400000, 3148992000, 3151584000, 3154176000, 3156681600 },
    {0, 3159273600, 3161779200, 3164371200, 3166876800, 3169468800, 3171974400, 3174480000, 3177072000, 3179577600, 3182169600, 3184761600, 3187267200 },
    {8, 3189859200, 3192451200, 3194956800, 3197548800, 3200054400, 3202646400, 3205152000, 3207657600, 3210249600, 3212755200, 3215347200, 3217852800, 3220444800 },
    {0, 3223036800, 3225628800, 3228134400, 3230726400, 3233232000, 3235824000, 3238329600, 3240835200, 3243427200, 3245932800, 3248524800, 3251030400 },
    {0, 3253622400, 3256214400, 3258720000, 3261312000, 3263904000, 3266409600, 3269001600, 3271507200, 3274012800, 3276604800, 3279110400, 3281702400 },
    {6, 3284208000, 3286800000, 3289305600, 3291897600, 3294489600, 3296995200, 3299587200, 3302092800, 3304684800, 3307190400, 3309782400, 3312288000, 3314880000 },
    {0, 3317385600, 3319977600, 3322483200, 3325075200, 3327580800, 3330172800, 3332764800, 3335270400, 3337862400, 3340368000, 3342960000, 3345465600 },
    {0, 3348057600, 3350563200, 3353155200, 3355660800, 3358252800, 3360758400, 3363350400, 3365856000, 3368448000, 3371040000, 3373545600, 3376137600 },
    {4, 3378643200, 3381235200, 3383740800, 3386332800, 3388838400, 3391344000, 3393936000, 3396441600, 3399033600, 3401625600, 3404217600, 3406723200, 3409315200 },
    {0, 3411820800, 3414412800, 3416918400, 3419510400, 3422016000, 3424521600, 3427113600, 3429619200, 3432211200, 3434803200, 3437308800, 3439900800 },
    {0, 3442492800, 3444998400, 3447590400, 3450096000, 3452688000, 3455193600, 3457699200, 3460291200, 3462796800, 3465388800, 3467894400, 3470486400 },
    {3, 3473078400, 3475670400, 3478176000, 3480768000, 3483273600, 3485865600, 3488371200, 3490876800, 3493468800, 3495974400, 3498480000, 3501072000, 3503664000 },
    {0, 3506256000, 3508761600, 3511353600, 3513945600, 3516451200, 3519043200, 3521548800, 3524054400, 3526646400, 3529152000, 3531657600, 3534249600 },
    {7, 3536841600, 3539347200, 3541939200, 3544531200, 3547123200, 3549628800, 3552134400, 3554726400, 3557232000, 3559824000, 3562329600, 3564835200, 3567427200 },
    {0, 3570019200, 3572524800, 3575116800, 3577708800, 3580214400, 3582806400, 3585312000, 3587904000, 3590409600, 3593001600, 3595507200, 3598099200 },
    {0, 3600604800, 3603196800, 3605702400, 3608294400, 3610800000, 3613392000, 3615984000, 3618489600, 3621081600, 3623587200, 3626179200, 3628684800 },
    {5, 3631276800, 3633782400, 3636374400, 3638880000, 3641385600, 3643977600, 3646569600, 3649075200, 3651667200, 3654259200, 3656764800, 3659356800, 3661862400 },
    {0, 3664454400, 3666960000, 3669552000, 3672057600, 3674563200, 3677155200, 3679660800, 3682252800, 3684844800, 3687350400, 3689942400, 3692534400 },
    {0, 3695040000, 3697632000, 3700137600, 3702729600, 3705235200, 3707740800, 3710332800, 3712838400, 3715430400, 3717936000, 3720528000, 3723120000 },
    {4, 3725712000, 3728217600, 3730809600, 3733315200, 3735907200, 3738412800, 3740918400, 3743510400, 3746016000, 3748521600, 3751113600, 3753705600, 3756297600 },
    {0, 3758803200, 3761395200, 3763987200, 3766492800, 3769084800, 3771590400, 3774096000, 3776688000, 3779193600, 3781699200, 3784291200, 3786883200 },
    {8, 3789388800, 3791980800, 3794572800, 3797164800, 3799670400, 3802262400, 3804768000, 3807273600, 3809865600, 3812371200, 3814876800, 3817468800, 3820060800 },
    {0, 3822566400, 3825158400, 3827750400, 3830256000, 3832848000, 3835353600, 3837945600, 3840451200, 3843043200, 3845548800, 3848054400, 3850646400 },
    {0, 3853152000, 3855744000, 3858336000, 3860841600, 3863433600, 3866025600, 3868531200, 3871123200, 3873628800, 3876220800, 3878726400, 3881318400 },
    {6, 3883824000, 3886329600, 3888921600, 3891513600, 3894019200, 3896611200, 3899116800, 3901708800, 3904300800, 3906806400, 3909398400, 3911904000, 3914496000 },
    {0, 3917001600, 3919507200, 3922099200, 3924604800, 3927196800, 3929702400, 3932294400, 3934886400, 3937392000, 3939984000, 3942576000, 3945081600 },
    {0, 3947673600, 3950179200, 3952771200, 3955276800, 3957782400, 3960374400, 3962880000, 3965472000, 3967977600, 3970569600, 3973161600, 3975753600 },
    {4, 3978259200, 3980851200, 3983356800, 3985948800, 3988454400, 3990960000, 3993552000, 3996057600, 3998563200, 4001155200, 4003747200, 4006339200, 4008844800 },
    {0, 4011436800, 4014028800, 4016534400, 4019126400, 4021632000, 4024137600, 4026729600, 4029235200, 4031740800, 4034332800, 4036924800, 4039430400 },
    {0, 4042022400, 4044614400, 4047206400, 4049712000, 4052304000, 4054809600, 4057315200, 4059820800, 4062412800, 4064918400, 4067510400, 4070016000 },
    {2, 4072608000, 4075200000, 4077792000, 4080297600, 4082889600, 4085481600, 4087987200, 4090492800, 4093084800, 4095590400, 4098096000, 4100688000, 4103193600 },
    {0, 4105785600, 4108377600, 4110969600, 4113475200, 4116067200, 4118572800, 4121164800, 4123670400, 4126262400, 4128768000, 4131273600, 4133865600 }
};


/************************************************
*公历年月映射该月1号在农历下的日期
*日期格式：从右到左分别为，日8bit，月8bit，年15bit，是否闰月1bit(0为否，1为是)
************************************************/
static __uint32_t stol_map[200][12] ={ 
    {0x7b10b18, 0x7b10c19, 0x7b20118, 0x7b20219, 0x7b2031a, 0x7b2041c, 0x7b2051c, 0x7b2061e, 0x7b20801, 0x7b20902, 0x7b20a03, 0x7b20b03 },
    {0x7b20c05, 0x7b30106, 0x7b30205, 0x7b30306, 0x7b30407, 0x7b30509, 0x87b30509, 0x7b3060b, 0x7b3070c, 0x7b3080d, 0x7b3090e, 0x7b30a0e },
    {0x7b30b0f, 0x7b30c11, 0x7b40110, 0x7b40212, 0x7b40312, 0x7b40414, 0x7b40515, 0x7b40616, 0x7b40718, 0x7b40818, 0x7b4091a, 0x7b40a1a },
    {0x7b40b1b, 0x7b40c1d, 0x7b5011b, 0x7b5021c, 0x7b5031d, 0x7b50501, 0x7b50602, 0x7b50703, 0x7b50805, 0x7b50906, 0x7b50a07, 0x7b50b07 },
    {0x7b50c09, 0x7b6010a, 0x7b60208, 0x7b60309, 0x7b6040a, 0x87b6040b, 0x7b6050c, 0x7b6060e, 0x7b6070f, 0x7b60810, 0x7b60912, 0x7b60a12 },
    {0x7b60b13, 0x7b60c15, 0x7b70113, 0x7b70214, 0x7b70314, 0x7b70416, 0x7b70516, 0x7b70618, 0x7b7071a, 0x7b7081a, 0x7b7091c, 0x7b70a1d },
    {0x7b70c01, 0x7b80102, 0x7b80201, 0x7b80302, 0x7b80403, 0x7b80504, 0x7b80605, 0x7b80706, 0x7b80808, 0x87b80808, 0x7b8090a, 0x7b80a0b },
    {0x7b80b0c, 0x7b80c0e, 0x7b9010c, 0x7b9020d, 0x7b9030e, 0x7b9040f, 0x7b9050f, 0x7b90611, 0x7b90712, 0x7b90813, 0x7b90914, 0x7b90a15 },
    {0x7b90b16, 0x7b90c18, 0x7ba0117, 0x7ba0218, 0x7ba0319, 0x7ba041a, 0x7ba051a, 0x7ba061c, 0x7ba071d, 0x7ba081d, 0x7ba0a01, 0x7ba0b02 },
    {0x7ba0c03, 0x7bb0105, 0x7bb0203, 0x7bb0305, 0x7bb0406, 0x7bb0507, 0x7bb0608, 0x87bb0609, 0x7bb070a, 0x7bb080b, 0x7bb090c, 0x7bb0a0c },
    {0x7bb0b0e, 0x7bb0c0f, 0x7bc010f, 0x7bc0210, 0x7bc0311, 0x7bc0413, 0x7bc0513, 0x7bc0615, 0x7bc0716, 0x7bc0817, 0x7bc0918, 0x7bc0a18 },
    {0x7bc0b1a, 0x7bc0c1b, 0x7bd0119, 0x7bd021b, 0x7bd031b, 0x7bd041d, 0x7bd051e, 0x7bd0702, 0x7bd0804, 0x7bd0904, 0x7bd0a05, 0x7bd0b06 },
    {0x7bd0c07, 0x7be0108, 0x7be0206, 0x7be0308, 0x7be0408, 0x87be040a, 0x7be050b, 0x7be060c, 0x7be070e, 0x7be080f, 0x7be0910, 0x7be0a11 },
    {0x7be0b12, 0x7be0c13, 0x7bf0111, 0x7bf0212, 0x7bf0313, 0x7bf0414, 0x7bf0515, 0x7bf0617, 0x7bf0718, 0x7bf0819, 0x7bf091b, 0x7bf0a1b },
    {0x7bf0b1d, 0x7bf0c1e, 0x7c0011d, 0x7c00301, 0x7c00401, 0x7c00502, 0x7c00603, 0x7c00705, 0x7c00806, 0x7c00907, 0x7c00a09, 0x87c00a09 },
    {0x7c00b0b, 0x7c00c0c, 0x7c1010a, 0x7c1020c, 0x7c1030c, 0x7c1040d, 0x7c1050e, 0x7c1060f, 0x7c10711, 0x7c10811, 0x7c10913, 0x7c10a14 },
    {0x7c10b15, 0x7c10c17, 0x7c20115, 0x7c20217, 0x7c20317, 0x7c20418, 0x7c20519, 0x7c2061a, 0x7c2071b, 0x7c2081c, 0x7c2091d, 0x7c20a1e },
    {0x7c20c02, 0x7c30104, 0x7c30202, 0x7c30304, 0x7c30404, 0x7c30506, 0x7c30606, 0x87c30607, 0x7c30709, 0x7c30809, 0x7c3090a, 0x7c30a0b },
    {0x7c30b0c, 0x7c30c0e, 0x7c4010e, 0x7c4020f, 0x7c40310, 0x7c40411, 0x7c40512, 0x7c40613, 0x7c40715, 0x7c40815, 0x7c40916, 0x7c40a17 },
    {0x7c40b18, 0x7c40c19, 0x7c50118, 0x7c50219, 0x7c5031a, 0x7c5041c, 0x7c5051c, 0x7c5061e, 0x7c50802, 0x7c50902, 0x7c50a04, 0x7c50b04 },
    {0x7c50c05, 0x7c60106, 0x7c60205, 0x7c60306, 0x7c60407, 0x7c60509, 0x87c60509, 0x7c6060b, 0x7c6070d, 0x7c6080d, 0x7c6090f, 0x7c60a0f },
    {0x7c60b10, 0x7c60c11, 0x7c7010f, 0x7c70211, 0x7c70311, 0x7c70413, 0x7c70514, 0x7c70615, 0x7c70717, 0x7c70818, 0x7c70919, 0x7c70a1a },
    {0x7c70b1b, 0x7c70c1c, 0x7c8011b, 0x7c8021d, 0x7c8031d, 0x7c80501, 0x7c80602, 0x7c80703, 0x7c80805, 0x7c80906, 0x7c80a07, 0x7c80b08 },
    {0x7c80c09, 0x7c9010a, 0x7c90209, 0x7c9030a, 0x87c9030a, 0x7c9040c, 0x7c9050c, 0x7c9060e, 0x7c9070f, 0x7c90810, 0x7c90912, 0x7c90a12 },
    {0x7c90b14, 0x7c90c15, 0x7ca0114, 0x7ca0215, 0x7ca0315, 0x7ca0416, 0x7ca0517, 0x7ca0618, 0x7ca071a, 0x7ca081a, 0x7ca091c, 0x7ca0a1d },
    {0x7ca0c01, 0x7cb0102, 0x7cb0201, 0x7cb0302, 0x7cb0402, 0x7cb0504, 0x7cb0604, 0x7cb0706, 0x7cb0807, 0x87cb0807, 0x7cb0909, 0x7cb0a0a },
    {0x7cb0b0b, 0x7cb0c0d, 0x7cc010c, 0x7cc020e, 0x7cc030e, 0x7cc0410, 0x7cc0510, 0x7cc0611, 0x7cc0713, 0x7cc0813, 0x7cc0915, 0x7cc0a15 },
    {0x7cc0b16, 0x7cc0c18, 0x7cd0117, 0x7cd0218, 0x7cd0319, 0x7cd041a, 0x7cd051b, 0x7cd061c, 0x7cd071e, 0x7cd081e, 0x7cd0a02, 0x7cd0b02 },
    {0x7cd0c03, 0x7ce0105, 0x7ce0203, 0x7ce0305, 0x7ce0406, 0x7ce0507, 0x87ce0508, 0x7ce060a, 0x7ce070b, 0x7ce080b, 0x7ce090d, 0x7ce0a0d },
    {0x7ce0b0e, 0x7ce0c10, 0x7cf010e, 0x7cf020f, 0x7cf0310, 0x7cf0412, 0x7cf0512, 0x7cf0614, 0x7cf0716, 0x7cf0816, 0x7cf0918, 0x7cf0a18 },
    {0x7cf0b19, 0x7cf0c1a, 0x7d0011a, 0x7d0021b, 0x7d0031b, 0x7d0041d, 0x7d0051e, 0x7d00702, 0x7d00804, 0x7d00904, 0x7d00a06, 0x7d00b06 },
    {0x7d00c07, 0x7d10109, 0x7d10207, 0x7d10308, 0x7d10409, 0x87d1040a, 0x7d1050b, 0x7d1060c, 0x7d1070e, 0x7d1080f, 0x7d10910, 0x7d10a11 },
    {0x7d10b12, 0x7d10c14, 0x7d20112, 0x7d20213, 0x7d20313, 0x7d20415, 0x7d20515, 0x7d20617, 0x7d20718, 0x7d20819, 0x7d2091b, 0x7d20a1b },
    {0x7d20b1d, 0x7d30101, 0x7d3011d, 0x7d3021e, 0x7d30401, 0x7d30502, 0x7d30602, 0x7d30704, 0x7d30805, 0x7d30906, 0x7d30a08, 0x7d30b08 },
    {0x7d30c0a, 0x7d4010b, 0x7d4020b, 0x87d4020c, 0x7d4030d, 0x7d4040e, 0x7d4050e, 0x7d40610, 0x7d40711, 0x7d40812, 0x7d40913, 0x7d40a14 },
    {0x7d40b15, 0x7d40c17, 0x7d50115, 0x7d50217, 0x7d50317, 0x7d50419, 0x7d50519, 0x7d5061b, 0x7d5071c, 0x7d5081c, 0x7d5091e, 0x7d50b01 },
    {0x7d50c02, 0x7d60104, 0x7d60202, 0x7d60304, 0x7d60404, 0x7d60506, 0x7d60606, 0x7d60708, 0x87d60709, 0x7d6080a, 0x7d6090b, 0x7d60a0b },
    {0x7d60b0d, 0x7d60c0e, 0x7d7010c, 0x7d7020e, 0x7d7030f, 0x7d70410, 0x7d70511, 0x7d70613, 0x7d70714, 0x7d70815, 0x7d70916, 0x7d70a16 },
    {0x7d70b17, 0x7d70c19, 0x7d80118, 0x7d80219, 0x7d8031a, 0x7d8041c, 0x7d8051c, 0x7d80701, 0x7d80802, 0x7d80903, 0x7d80a04, 0x7d80b04 },
    {0x7d80c06, 0x7d90107, 0x7d90205, 0x7d90306, 0x7d90407, 0x7d90509, 0x87d90509, 0x7d9060b, 0x7d9070d, 0x7d9080d, 0x7d9090f, 0x7d90a0f },
    {0x7d90b11, 0x7d90c12, 0x7da0110, 0x7da0211, 0x7da0312, 0x7da0413, 0x7da0514, 0x7da0615, 0x7da0717, 0x7da0818, 0x7da0919, 0x7da0a1a },
    {0x7da0b1b, 0x7da0c1d, 0x7db011b, 0x7db021c, 0x7db031d, 0x7db041e, 0x7db0601, 0x7db0702, 0x7db0804, 0x7db0905, 0x7db0a06, 0x7db0b07 },
    {0x7db0c08, 0x7dc010a, 0x7dc0209, 0x7dc030b, 0x7dc040b, 0x87dc040c, 0x7dc050d, 0x7dc060e, 0x7dc0710, 0x7dc0810, 0x7dc0912, 0x7dc0a12 },
    {0x7dc0b14, 0x7dc0c15, 0x7dd0114, 0x7dd0215, 0x7dd0316, 0x7dd0417, 0x7dd0518, 0x7dd0619, 0x7dd071a, 0x7dd081b, 0x7dd091c, 0x7dd0a1d },
    {0x7dd0c01, 0x7de0102, 0x7de0201, 0x7de0302, 0x7de0403, 0x7de0504, 0x7de0605, 0x7de0706, 0x7de0808, 0x7de0908, 0x87de0909, 0x7de0a0a },
    {0x7de0b0b, 0x7de0c0d, 0x7df010b, 0x7df020d, 0x7df030d, 0x7df040f, 0x7df0510, 0x7df0611, 0x7df0713, 0x7df0813, 0x7df0914, 0x7df0a14 },
    {0x7df0b16, 0x7df0c17, 0x7e00117, 0x7e00218, 0x7e00319, 0x7e0041a, 0x7e0051b, 0x7e0061d, 0x7e00801, 0x7e00901, 0x7e00a02, 0x7e00b03 },
    {0x7e00c04, 0x7e10105, 0x7e10204, 0x7e10305, 0x7e10406, 0x7e10507, 0x7e10608, 0x87e1060a, 0x7e1070b, 0x7e1080c, 0x7e1090d, 0x7e10a0e },
    {0x7e10b0f, 0x7e10c10, 0x7e2010e, 0x7e20210, 0x7e20310, 0x7e20412, 0x7e20512, 0x7e20614, 0x7e20716, 0x7e20816, 0x7e20918, 0x7e20a18 },
    {0x7e20b1a, 0x7e20c1b, 0x7e30119, 0x7e3021a, 0x7e3031b, 0x7e3041c, 0x7e3051d, 0x7e30701, 0x7e30803, 0x7e30903, 0x7e30a05, 0x7e30b06 },
    {0x7e30c07, 0x7e40108, 0x7e40208, 0x7e40309, 0x7e40409, 0x87e4040a, 0x7e4050b, 0x7e4060c, 0x7e4070e, 0x7e4080f, 0x7e40910, 0x7e40a11 },
    {0x7e40b12, 0x7e40c14, 0x7e50112, 0x7e50214, 0x7e50314, 0x7e50415, 0x7e50516, 0x7e50617, 0x7e50719, 0x7e50819, 0x7e5091b, 0x7e50a1b },
    {0x7e50b1d, 0x7e60101, 0x7e6011d, 0x7e60301, 0x7e60401, 0x7e60503, 0x7e60603, 0x7e60704, 0x7e60806, 0x7e60906, 0x7e60a08, 0x7e60b08 },
    {0x7e60c0a, 0x7e7010b, 0x7e7020a, 0x87e7020b, 0x7e7030c, 0x7e7040e, 0x7e7050e, 0x7e7060f, 0x7e70711, 0x7e70811, 0x7e70912, 0x7e70a13 },
    {0x7e70b14, 0x7e70c16, 0x7e80115, 0x7e80217, 0x7e80317, 0x7e80419, 0x7e8051a, 0x7e8061b, 0x7e8071d, 0x7e8081d, 0x7e80a01, 0x7e80b01 },
    {0x7e80c02, 0x7e90104, 0x7e90202, 0x7e90304, 0x7e90404, 0x7e90506, 0x7e90607, 0x87e90608, 0x7e9070a, 0x7e9080a, 0x7e9090c, 0x7e90a0c },
    {0x7e90b0d, 0x7e90c0e, 0x7ea010d, 0x7ea020e, 0x7ea030f, 0x7ea0410, 0x7ea0511, 0x7ea0613, 0x7ea0714, 0x7ea0815, 0x7ea0917, 0x7ea0a17 },
    {0x7ea0b18, 0x7ea0c19, 0x7eb0118, 0x7eb0219, 0x7eb0319, 0x7eb041b, 0x7eb051b, 0x7eb061d, 0x7eb0801, 0x7eb0902, 0x7eb0a04, 0x7eb0b04 },
    {0x7eb0c05, 0x7ec0107, 0x7ec0206, 0x7ec0307, 0x7ec0407, 0x7ec0509, 0x87ec0509, 0x7ec060b, 0x7ec070d, 0x7ec080d, 0x7ec090f, 0x7ec0a10 },
    {0x7ec0b11, 0x7ec0c12, 0x7ed0111, 0x7ed0212, 0x7ed0312, 0x7ed0414, 0x7ed0514, 0x7ed0616, 0x7ed0717, 0x7ed0818, 0x7ed0919, 0x7ed0a1a },
    {0x7ed0b1c, 0x7ed0c1d, 0x7ee011b, 0x7ee021d, 0x7ee031d, 0x7ee0501, 0x7ee0601, 0x7ee0703, 0x7ee0804, 0x7ee0905, 0x7ee0a06, 0x7ee0b07 },
    {0x7ee0c08, 0x7ef010a, 0x7ef0209, 0x7ef030a, 0x87ef030a, 0x7ef040c, 0x7ef050c, 0x7ef060e, 0x7ef070f, 0x7ef080f, 0x7ef0911, 0x7ef0a11 },
    {0x7ef0b13, 0x7ef0c14, 0x7f00114, 0x7f00215, 0x7f00316, 0x7f00418, 0x7f00518, 0x7f0061a, 0x7f0071b, 0x7f0081b, 0x7f0091d, 0x7f00a1d },
    {0x7f00c01, 0x7f10102, 0x7f10201, 0x7f10302, 0x7f10403, 0x7f10505, 0x7f10605, 0x7f10707, 0x7f10808, 0x7f10909, 0x7f10a0a, 0x7f10b0a },
    {0x87f10b0b, 0x7f10c0d, 0x7f2010b, 0x7f2020d, 0x7f2030d, 0x7f2040f, 0x7f20510, 0x7f20611, 0x7f20713, 0x7f20813, 0x7f20915, 0x7f20a15 },
    {0x7f20b16, 0x7f20c18, 0x7f30116, 0x7f30217, 0x7f30318, 0x7f30419, 0x7f3051a, 0x7f3061c, 0x7f3071d, 0x7f30901, 0x7f30a02, 0x7f30b02 },
    {0x7f30c04, 0x7f40105, 0x7f40204, 0x7f40305, 0x7f40406, 0x7f40507, 0x7f40608, 0x87f4060a, 0x7f4070b, 0x7f4080c, 0x7f4090e, 0x7f40a0e },
    {0x7f40b10, 0x7f40c11, 0x7f5010f, 0x7f50210, 0x7f50310, 0x7f50412, 0x7f50512, 0x7f50614, 0x7f50716, 0x7f50816, 0x7f50918, 0x7f50a19 },
    {0x7f50b1a, 0x7f50c1c, 0x7f6011a, 0x7f6021b, 0x7f6031b, 0x7f6041d, 0x7f6051d, 0x7f60701, 0x7f60803, 0x7f60903, 0x7f60a05, 0x7f60b06 },
    {0x7f60c07, 0x7f70109, 0x7f70207, 0x7f70308, 0x7f70409, 0x7f7050a, 0x87f7050a, 0x7f7060c, 0x7f7070d, 0x7f7080e, 0x7f7090f, 0x7f70a10 },
    {0x7f70b11, 0x7f70c13, 0x7f80113, 0x7f80214, 0x7f80315, 0x7f80416, 0x7f80516, 0x7f80618, 0x7f80719, 0x7f8081a, 0x7f8091b, 0x7f80a1b },
    {0x7f80b1d, 0x7f90101, 0x7f9011d, 0x7f90301, 0x7f90402, 0x7f90503, 0x7f90604, 0x7f90705, 0x7f90806, 0x7f90907, 0x7f90a08, 0x7f90b08 },
    {0x7f90c0a, 0x7fa010b, 0x7fa020a, 0x87fa020b, 0x7fa030c, 0x7fa040e, 0x7fa050e, 0x7fa0610, 0x7fa0711, 0x7fa0812, 0x7fa0913, 0x7fa0a13 },
    {0x7fa0b15, 0x7fa0c16, 0x7fb0114, 0x7fb0216, 0x7fb0316, 0x7fb0418, 0x7fb0519, 0x7fb061a, 0x7fb071c, 0x7fb081d, 0x7fb091e, 0x7fb0b01 },
    {0x7fb0c02, 0x7fc0103, 0x7fc0202, 0x7fc0304, 0x7fc0404, 0x7fc0506, 0x7fc0607, 0x7fc0708, 0x87fc070a, 0x7fc080b, 0x7fc090c, 0x7fc0a0d },
    {0x7fc0b0e, 0x7fc0c0f, 0x7fd010d, 0x7fd020e, 0x7fd030f, 0x7fd0410, 0x7fd0511, 0x7fd0613, 0x7fd0714, 0x7fd0815, 0x7fd0917, 0x7fd0a17 },
    {0x7fd0b19, 0x7fd0c1a, 0x7fe0118, 0x7fe0219, 0x7fe031a, 0x7fe041b, 0x7fe051c, 0x7fe061d, 0x7fe0801, 0x7fe0902, 0x7fe0a04, 0x7fe0b04 },
    {0x7fe0c06, 0x7ff0107, 0x7ff0205, 0x7ff0307, 0x7ff0407, 0x7ff0508, 0x87ff0509, 0x7ff060a, 0x7ff070c, 0x7ff080c, 0x7ff090e, 0x7ff0a0f },
    {0x7ff0b10, 0x7ff0c12, 0x8000111, 0x8000213, 0x8000313, 0x8000414, 0x8000515, 0x8000616, 0x8000717, 0x8000818, 0x8000919, 0x8000a1a },
    {0x8000b1c, 0x8000c1d, 0x801011c, 0x801021d, 0x801031e, 0x8010502, 0x8010602, 0x8010703, 0x8010805, 0x8010905, 0x8010a06, 0x8010b07 },
    {0x8010c08, 0x802010a, 0x8020209, 0x802030a, 0x8802030b, 0x802040c, 0x802050d, 0x802060e, 0x8020710, 0x8020810, 0x8020911, 0x8020a12 },
    {0x8020b13, 0x8020c14, 0x8030113, 0x8030214, 0x8030315, 0x8030417, 0x8030517, 0x8030619, 0x803071b, 0x803081b, 0x803091c, 0x8030a1d },
    {0x8030b1e, 0x8040101, 0x8040201, 0x8040302, 0x8040403, 0x8040505, 0x8040605, 0x8040707, 0x8040809, 0x88040809, 0x804090b, 0x8040a0b },
    {0x8040b0c, 0x8040c0d, 0x805010b, 0x805020d, 0x805030d, 0x805040f, 0x8050510, 0x8050611, 0x8050713, 0x8050814, 0x8050915, 0x8050a16 },
    {0x8050b17, 0x8050c18, 0x8060116, 0x8060218, 0x8060318, 0x8060419, 0x806051a, 0x806061c, 0x806071d, 0x8060901, 0x8060a02, 0x8060b03 },
    {0x8060c04, 0x8070105, 0x8070204, 0x8070305, 0x8070405, 0x8070507, 0x8070607, 0x88070609, 0x807070a, 0x807080b, 0x807090d, 0x8070a0d },
    {0x8070b0f, 0x8070c10, 0x8080110, 0x8080211, 0x8080311, 0x8080412, 0x8080513, 0x8080614, 0x8080716, 0x8080816, 0x8080918, 0x8080a19 },
    {0x8080b1a, 0x8080c1c, 0x809011a, 0x809021c, 0x809031c, 0x809041d, 0x809051e, 0x8090702, 0x8090803, 0x8090903, 0x8090a05, 0x8090b06 },
    {0x8090c07, 0x80a0109, 0x80a0207, 0x80a0309, 0x80a0409, 0x880a040b, 0x80a050b, 0x80a060d, 0x80a070e, 0x80a080e, 0x80a0910, 0x80a0a10 },
    {0x80a0b11, 0x80a0c13, 0x80b0112, 0x80b0213, 0x80b0314, 0x80b0415, 0x80b0516, 0x80b0617, 0x80b0719, 0x80b0819, 0x80b091b, 0x80b0a1b },
    {0x80b0b1c, 0x80b0c1d, 0x80c011d, 0x80c0301, 0x80c0402, 0x80c0503, 0x80c0604, 0x80c0706, 0x80c0807, 0x80c0908, 0x80c0a09, 0x80c0b09 },
    {0x80c0c0a, 0x80d010c, 0x80d020a, 0x80d030b, 0x880d030c, 0x80d040e, 0x80d050e, 0x80d0610, 0x80d0712, 0x80d0812, 0x80d0914, 0x80d0a14 },
    {0x80d0b15, 0x80d0c16, 0x80e0115, 0x80e0216, 0x80e0316, 0x80e0418, 0x80e0519, 0x80e061a, 0x80e071c, 0x80e081d, 0x80e0a01, 0x80e0b01 },
    {0x80e0c02, 0x80f0104, 0x80f0202, 0x80f0303, 0x80f0404, 0x80f0505, 0x80f0606, 0x80f0707, 0x880f0709, 0x80f080a, 0x80f090b, 0x80f0a0c },
    {0x80f0b0d, 0x80f0c0f, 0x810010e, 0x810020f, 0x810030f, 0x8100411, 0x8100511, 0x8100613, 0x8100714, 0x8100815, 0x8100917, 0x8100a17 },
    {0x8100b19, 0x8100c1a, 0x8110119, 0x811021a, 0x811031a, 0x811041c, 0x811051c, 0x811061d, 0x8110801, 0x8110902, 0x8110a04, 0x8110b04 },
    {0x8110c06, 0x8120107, 0x8120206, 0x8120307, 0x8120408, 0x8120509, 0x88120509, 0x812060b, 0x812070c, 0x812080d, 0x812090e, 0x8120a0f },
    {0x8120b10, 0x8120c12, 0x8130110, 0x8130212, 0x8130312, 0x8130414, 0x8130514, 0x8130616, 0x8130717, 0x8130817, 0x8130919, 0x8130a19 },
    {0x8130b1b, 0x8130c1c, 0x814011c, 0x814021d, 0x814031e, 0x8140502, 0x8140603, 0x8140704, 0x8140805, 0x8140906, 0x8140a07, 0x8140b07 },
    {0x8140c09, 0x815010a, 0x8150209, 0x815030a, 0x815040b, 0x8815040c, 0x815050d, 0x815060f, 0x8150710, 0x8150811, 0x8150912, 0x8150a12 },
    {0x8150b13, 0x8150c15, 0x8160113, 0x8160215, 0x8160315, 0x8160417, 0x8160517, 0x8160619, 0x816071b, 0x816081b, 0x816091d, 0x8160a1d },
    {0x8160c01, 0x8170102, 0x817011e, 0x8170302, 0x8170402, 0x8170504, 0x8170604, 0x8170706, 0x8170808, 0x88170808, 0x817090a, 0x8170a0a },
    {0x8170b0c, 0x8170c0d, 0x818010c, 0x818020d, 0x818030e, 0x818040f, 0x8180510, 0x8180611, 0x8180713, 0x8180814, 0x8180915, 0x8180a16 },
    {0x8180b17, 0x8180c19, 0x8190117, 0x8190218, 0x8190319, 0x819041a, 0x819051a, 0x819061c, 0x819071d, 0x8190901, 0x8190a02, 0x8190b03 },
    {0x8190c04, 0x81a0106, 0x81a0204, 0x81a0306, 0x81a0406, 0x81a0507, 0x81a0608, 0x881a0609, 0x81a070b, 0x81a080b, 0x81a090d, 0x81a0a0d },
    {0x81a0b0f, 0x81a0c10, 0x81b010f, 0x81b0210, 0x81b0311, 0x81b0412, 0x81b0513, 0x81b0614, 0x81b0715, 0x81b0816, 0x81b0917, 0x81b0a18 },
    {0x81b0b19, 0x81b0c1b, 0x81c011a, 0x81c021c, 0x81c031c, 0x81c041e, 0x81c0601, 0x81c0702, 0x81c0804, 0x81c0904, 0x81c0a05, 0x81c0b06 },
    {0x81c0c07, 0x81d0109, 0x81d0207, 0x81d0309, 0x81d0409, 0x881d040b, 0x81d050c, 0x81d060d, 0x81d070f, 0x81d080f, 0x81d0910, 0x81d0a10 },
    {0x81d0b12, 0x81d0c13, 0x81e0112, 0x81e0213, 0x81e0314, 0x81e0415, 0x81e0516, 0x81e0618, 0x81e0719, 0x81e081a, 0x81e091b, 0x81e0a1b },
    {0x81e0b1d, 0x81e0c1e, 0x81f011c, 0x81f021e, 0x81f0401, 0x81f0502, 0x81f0603, 0x81f0705, 0x81f0806, 0x81f0907, 0x81f0a08, 0x81f0b09 },
    {0x81f0c0a, 0x820010b, 0x820020a, 0x820030c, 0x8820030c, 0x820040e, 0x820050e, 0x8200610, 0x8200712, 0x8200812, 0x8200914, 0x8200a15 },
    {0x8200b16, 0x8200c17, 0x8210115, 0x8210217, 0x8210317, 0x8210418, 0x8210519, 0x821061a, 0x821071c, 0x821081d, 0x8210a01, 0x8210b02 },
    {0x8210c03, 0x8220104, 0x8220203, 0x8220304, 0x8220404, 0x8220505, 0x8220606, 0x8220708, 0x88220709, 0x822080a, 0x822090b, 0x8220a0c },
    {0x8220b0e, 0x8220c0f, 0x823010d, 0x823020f, 0x823030f, 0x8230410, 0x8230511, 0x8230612, 0x8230714, 0x8230814, 0x8230916, 0x8230a16 },
    {0x8230b18, 0x8230c19, 0x8240119, 0x824021a, 0x824031b, 0x824041c, 0x824051d, 0x824061e, 0x8240802, 0x8240902, 0x8240a04, 0x8240b04 },
    {0x8240c06, 0x8250107, 0x8250206, 0x8250307, 0x8250408, 0x825050a, 0x8825050a, 0x825060b, 0x825070d, 0x825080d, 0x825090e, 0x8250a0f },
    {0x8250b10, 0x8250c12, 0x8260110, 0x8260212, 0x8260312, 0x8260414, 0x8260515, 0x8260616, 0x8260718, 0x8260818, 0x8260919, 0x8260a1a },
    {0x8260b1b, 0x8260c1c, 0x827011b, 0x827021c, 0x827031d, 0x8270501, 0x8270602, 0x8270703, 0x8270805, 0x8270905, 0x8270a07, 0x8270b07 },
    {0x8270c08, 0x8280109, 0x8280209, 0x828030a, 0x828040b, 0x8828040c, 0x828050d, 0x828060f, 0x8280710, 0x8280811, 0x8280913, 0x8280a13 },
    {0x8280b14, 0x8280c15, 0x8290114, 0x8290215, 0x8290315, 0x8290417, 0x8290517, 0x8290619, 0x829071b, 0x829081b, 0x829091d, 0x8290a1e },
    {0x8290c01, 0x82a0103, 0x82a0201, 0x82a0302, 0x82a0402, 0x82a0504, 0x82a0604, 0x82a0706, 0x82a0808, 0x882a0808, 0x82a090a, 0x82a0a0b },
    {0x82a0b0c, 0x82a0c0d, 0x82b010c, 0x82b020d, 0x82b030d, 0x82b040f, 0x82b050f, 0x82b0611, 0x82b0712, 0x82b0813, 0x82b0914, 0x82b0a15 },
    {0x82b0b17, 0x82b0c18, 0x82c0118, 0x82c0219, 0x82c0319, 0x82c041b, 0x82c051b, 0x82c061c, 0x82c071e, 0x82c0901, 0x82c0a02, 0x82c0b03 },
    {0x82c0c04, 0x82d0106, 0x82d0205, 0x82d0306, 0x82d0406, 0x82d0508, 0x82d0608, 0x882d060a, 0x82d070b, 0x82d080b, 0x82d090d, 0x82d0a0d },
    {0x82d0b0f, 0x82d0c10, 0x82e010f, 0x82e0211, 0x82e0311, 0x82e0413, 0x82e0513, 0x82e0615, 0x82e0716, 0x82e0816, 0x82e0918, 0x82e0a18 },
    {0x82e0b19, 0x82e0c1b, 0x82f0119, 0x82f021b, 0x82f031b, 0x82f041d, 0x82f051e, 0x82f0702, 0x82f0803, 0x82f0904, 0x82f0a05, 0x82f0b05 },
    {0x82f0c06, 0x8300108, 0x8300207, 0x8300309, 0x8300409, 0x8830040b, 0x830050c, 0x830060d, 0x830070f, 0x8300810, 0x8300911, 0x8300a11 },
    {0x8300b12, 0x8300c14, 0x8310112, 0x8310213, 0x8310314, 0x8310415, 0x8310516, 0x8310618, 0x8310719, 0x831081a, 0x831091c, 0x8310a1c },
    {0x8310b1d, 0x8320101, 0x832011d, 0x832021e, 0x8320401, 0x8320502, 0x8320603, 0x8320705, 0x8320807, 0x8320907, 0x8320a09, 0x8320b09 },
    {0x8320c0b, 0x833010c, 0x833020a, 0x8833020b, 0x833030c, 0x833040d, 0x833050d, 0x833060f, 0x8330711, 0x8330811, 0x8330913, 0x8330a14 },
    {0x8330b15, 0x8330c17, 0x8340115, 0x8340216, 0x8340316, 0x8340418, 0x8340518, 0x834061a, 0x834071b, 0x834081c, 0x834091d, 0x8340b01 }
};





static int getIndex(int year, int month, int isleap) {
    __int64_t leapindex = ltos_map[year-MIN_YEAR][0];
    if ( leapindex > 0 ) {
        if ( month > leapindex  || isleap==1 && month==leapindex ) {
            return 1 + month;//大于闰月的月都加1 ,或闰月
        }
    }
    return month;   
}


static void parseLunarData(int year, int month, lunar_data_t * pLunarData) {
    __uint32_t bitdata = stol_map[year-MIN_YEAR][month-1];
    pLunarData->day = bitdata & 0x000000FF;
    pLunarData->month = (bitdata & 0x0000FF00)>>8;
    pLunarData->year = (bitdata & 0x7FFF0000)>>16;
    pLunarData->isleap = (bitdata & 0x80000000)>>31; 
}



static int getMonthSize(__uint32_t bitdata, int month, int isleap){
    if( isleap == 1 ){//该月为闰月，故最后一个位为闰月大小
        return (bitdata & 0x00000001) + 29;
    }
    __uint32_t move = 13-month;
    move = (bitdata >> move) & 0x00000001  ;
    
    return move+29;
}


/**************************
*农历转公历 
*@year 年
*@month 月
*@day 日
*@isleap 是否闰月,当闰月时应置1
*@return 公历公历时间戳
***************************/
int lunar_to_solar(int year, int month, int day, int isleap, solar_data_t *pSolarData) {
    bzero(pSolarData, sizeof(solar_data_t));
    __int64_t timestamp = ltos_map[year-MIN_YEAR][getIndex(year, month, isleap)];
    __int64_t temp = timestamp;
    timestamp += DAYTIME * (day - 1) + 3600;
    struct tm formatstamp;
    bzero(&formatstamp, sizeof(struct tm));
//    localtime_r((time_t*)&timestamp, &formatstamp);
//    localtime_r((time_t*)&temp, &formatstamp);
//    if( formatstamp.tm_isdst == 1)
//        timestamp +=  3600;
    localtime_r((time_t*)&timestamp, &formatstamp);
    pSolarData->year = formatstamp.tm_year+1900;
    pSolarData->month = formatstamp.tm_mon+1;
    pSolarData->day = formatstamp.tm_mday; 
        
    // return (int)timestamp;
    //return (int)formatstamp.tm_isdst;
    return (int)temp;
}


__int64_t lunar_to_stamp(int year, int month, int day, int isleap) {
    __int64_t timestamp = ltos_map[year-MIN_YEAR][getIndex(year, month, isleap)];
    timestamp += DAYTIME * (day - 1);
    //由于本映射是映射出东8区的当天00:00:00时的时间戳
    return timestamp+28800; 
}


/**************************
*公历转农历 *注意：由于闰12月本人有生之年碰不上，故假设没有这事
*@year 年
*@month 月
*@day 日
*@return 成功返回0，否则-1
***************************/
int solar_to_lunar(int year, int month, int day, lunar_data_t *pLunarData) {

    bzero(pLunarData, sizeof(lunar_data_t));
    //获取该公历月第一天对应农历日期
    parseLunarData(year, month, pLunarData);
    
    __uint32_t bitdata = years_info[pLunarData->year - MIN_YEAR];

    while(1){    
        //农历月剩余天数
        int surplus = getMonthSize( bitdata, pLunarData->month, pLunarData->isleap) - pLunarData->day;
        
        if( (day-1) <= surplus) {//如果剩余天数小于day则直接加上公历日的天数减1
            pLunarData->day += day - 1;
            return 1;
        }
    
        day = day-1-surplus;
        pLunarData->day=1;
    
            
        if(pLunarData->month == 12){
            pLunarData->year += 1;
            pLunarData->month = 1;
            bitdata = years_info[pLunarData->year - MIN_YEAR];//重新获取农历年信息
            pLunarData->isleap = 0;
        }else {
            //获取闰月索引 
            __uint32_t leapindex = bitdata>>13;
            if( pLunarData->month == leapindex && pLunarData->isleap == 0 ){//闰月前面那个月
                pLunarData->isleap = 1;
            } else {
                pLunarData->month += 1;
                pLunarData->isleap = 0;
            }
            
        }
    
    }
   
    return 0;
}

/**************************************
*公历年月日添加年份
*@year、month、day 原时间的公历年月日
*@addyear_cnt 添加的年分
*@return 返回更新后的时间戳
****************************************/
__int64_t add_lunaryear(int year, int month, int day, int addyear_cnt, triger_result_t *triger_result) {
    triger_result->leapstamp = 0;
    
//int solar_to_lunar(int year, int month, int day, lunar_data_t *pLunarData) {
    lunar_data_t lunar_data;
    solar_to_lunar(year, month, day, &lunar_data);

    //判断原日程是否闰月
    int isleap = lunar_data.isleap;

    lunar_data.year += addyear_cnt;
    
    __uint32_t bitdata = years_info[lunar_data.year - MIN_YEAR];
    __int64_t leapindex = ltos_map[lunar_data.year-MIN_YEAR][0];//用于判断闰月情况
    
    //原日程是闰月且更新后的年也是该月闰月的情况
    if ( isleap==1 && leapindex == lunar_data.month ){
        //先计算闰月情况
        int monthsize = getMonthSize(bitdata, lunar_data.month, 1);
        int oldday = lunar_data.day;
        if(oldday > monthsize){
            oldday = monthsize;
        }
        triger_result->leapstamp = lunar_to_stamp(lunar_data.year, lunar_data.month, oldday, 1);
        //计算非闰月清况
        monthsize = getMonthSize(bitdata, lunar_data.month, 0);
        if(lunar_data.day > monthsize){
            lunar_data.day = monthsize;
        }
        triger_result->stamp = lunar_to_stamp(lunar_data.year, lunar_data.month, lunar_data.day, 0);
        return 0;
    } else { //只计算该非闰月的
        int monthsize = getMonthSize(bitdata, lunar_data.month, 0);
        if(lunar_data.day > monthsize){
            lunar_data.day = monthsize;
        }
        triger_result->stamp = lunar_to_stamp(lunar_data.year, lunar_data.month, lunar_data.day, 0);
        return 0;
    }
    
    return 0;

};


__int64_t add_lunarmonth(int year, int month, int day, int addmonth_cnt) {
    lunar_data_t lunar_data;
    solar_to_lunar(year, month, day, &lunar_data);
    __int64_t leapindex = ltos_map[lunar_data.year-MIN_YEAR][0];//用于判断闰月情况
    if(lunar_data.isleap == 1 || leapindex > 0 && lunar_data.month > leapindex){
        lunar_data.month += 1;
    }
    lunar_data.isleap = 0;
    __uint32_t bitdata;
    while(1) {
        bitdata = years_info[lunar_data.year - MIN_YEAR];
        leapindex = ltos_map[lunar_data.year-MIN_YEAR][0];//用于判断闰月情况
        int monthcnt = 12; //记录该年月份数量
        if ( leapindex > 0 ){
            monthcnt = 13;
        }
        
        lunar_data.month += addmonth_cnt;
        if( lunar_data.month > monthcnt ){
            addmonth_cnt = lunar_data.month - monthcnt - 1;
            lunar_data.month = 1;
            lunar_data.year += 1;
        } else {//可以退出循环的情况
            if( leapindex == 0 || lunar_data.month <= leapindex ) {//无闰月情况,和小于闰月情况
                break;
            }else if( leapindex == lunar_data.month - 1) {
                lunar_data.isleap = 1;
                lunar_data.month -= 1;
            }else {
                lunar_data.month -= 1;
            }
            break;
        }
    }
 
    //判断该月的日是否超出情况
    int monthsize = getMonthSize(bitdata, lunar_data.month, lunar_data.isleap);
    if(lunar_data.day > monthsize ) {
        lunar_data.day = monthsize;
    } 
//    php_printf("%d %d %d %d\n",lunar_data.year, lunar_data.month, lunar_data.day, lunar_data.isleap );
    return lunar_to_stamp(lunar_data.year, lunar_data.month, lunar_data.day, lunar_data.isleap);
}

